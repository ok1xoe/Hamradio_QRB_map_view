<!doctype html>
<html lang="cs">
<head>
    <meta charset="utf-8" />
    <title>Hamradio QRB map viewer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@latest/ol.css" />
    <link rel="stylesheet" href="./styles.css" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9CCJ74WGQM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-9CCJ74WGQM');
    </script>
</head>
<body>

<div id="map"></div>

<!-- Okno: Vrstvy (vlevo) -->
<div class="layers" id="layersPanel" role="region" aria-label="Vrstvy">
    <div class="layers-header">
        <div class="title" id="lblLayersTitle">Vrstvy</div>
    </div>
    <div class="layers-body">
        <ul class="layers-tree" role="tree" aria-label="Seznam vrstev">
            <li role="treeitem" aria-expanded="true">
                <div class="node">
                    <span class="twisty" aria-hidden="true"></span>

                    <label class="layer-item">
                        <input id="layerMap" type="checkbox" checked disabled />
                        <span id="lblLayerMap">Mapa</span>
                    </label>
                </div>

                <ul role="group">

                    <!-- Názvy DXCC (textové štítky) -->
                    <li role="treeitem">
                        <div class="node leaf">
                            <span class="twisty" aria-hidden="true"></span>
                            <label class="layer-item">
                                <input id="layerDxccLabels" type="checkbox" checked />
                                <span id="lblLayerDxccLabels">Názvy DXCC</span>
                            </label>
                            <input id="dxccLabelSize" class="dxcc-label-size" type="number" min="8" max="32" step="1" value="12" aria-label="Velikost popisku DXCC" />
                        </div>
                    </li>

                    <!-- DXCC -->
                    <li role="treeitem" aria-expanded="true">
                        <div class="node">
                            <span class="twisty" aria-hidden="true"></span>

                            <label class="layer-item">
                                <input id="layerDxcc" type="checkbox" checked />
                                <span id="lblLayerDxcc">DXCC</span>
                            </label>
                        </div>

                        <ul role="group">
                            <li role="treeitem">
                                <div class="node leaf">
                                    <span class="twisty" aria-hidden="true"></span>

                                    <label class="layer-item">
                                        <input id="layerDxccCw" type="checkbox" checked />
                                        <span id="lblLayerDxccCw">CW</span>
                                    </label>

                                    <button class="color-btn" type="button" data-color-key="dxcc.cw" aria-label="Barva: DXCC CW">
                                        <span class="swatch" data-swatch-key="dxcc.cw"></span>
                                    </button>
                                </div>
                            </li>

                            <li role="treeitem">
                                <div class="node leaf">
                                    <span class="twisty" aria-hidden="true"></span>

                                    <label class="layer-item">
                                        <input id="layerDxccSsb" type="checkbox" checked />
                                        <span id="lblLayerDxccSsb">SSB</span>
                                    </label>

                                    <button class="color-btn" type="button" data-color-key="dxcc.ssb" aria-label="Barva: DXCC SSB">
                                        <span class="swatch" data-swatch-key="dxcc.ssb"></span>
                                    </button>
                                </div>
                            </li>

                            <li role="treeitem">
                                <div class="node leaf">
                                    <span class="twisty" aria-hidden="true"></span>

                                    <label class="layer-item">
                                        <input id="layerDxccOther" type="checkbox" checked />
                                        <span id="lblLayerDxccOther">Ostatní</span>
                                    </label>

                                    <button class="color-btn" type="button" data-color-key="dxcc.other" aria-label="Barva: DXCC Ostatní">
                                        <span class="swatch" data-swatch-key="dxcc.other"></span>
                                    </button>
                                </div>
                            </li>

                            <!-- DIGI (DXCC) -->
                            <li role="treeitem" aria-expanded="true">
                                <div class="node">
                                    <span class="twisty" aria-hidden="true"></span>

                                    <label class="layer-item">
                                        <input id="layerDxccDigi" type="checkbox" checked />
                                        <span id="lblLayerDxccDigi">DIGI</span>
                                    </label>
                                </div>

                                <ul role="group">
                                    <li role="treeitem">
                                        <div class="node leaf">
                                            <span class="twisty" aria-hidden="true"></span>
                                            <label class="layer-item">
                                                <input id="layerDxccDigiFt8" type="checkbox" checked />
                                                <span id="lblLayerDxccDigiFt8">FT8</span>
                                            </label>
                                            <button class="color-btn" type="button" data-color-key="dxcc.digi.ft8" aria-label="Barva: DXCC FT8">
                                                <span class="swatch" data-swatch-key="dxcc.digi.ft8"></span>
                                            </button>
                                        </div>
                                    </li>

                                    <li role="treeitem">
                                        <div class="node leaf">
                                            <span class="twisty" aria-hidden="true"></span>
                                            <label class="layer-item">
                                                <input id="layerDxccDigiFt4" type="checkbox" checked />
                                                <span id="lblLayerDxccDigiFt4">FT4</span>
                                            </label>
                                            <button class="color-btn" type="button" data-color-key="dxcc.digi.ft4" aria-label="Barva: DXCC FT4">
                                                <span class="swatch" data-swatch-key="dxcc.digi.ft4"></span>
                                            </button>
                                        </div>
                                    </li>

                                    <li role="treeitem">
                                        <div class="node leaf">
                                            <span class="twisty" aria-hidden="true"></span>
                                            <label class="layer-item">
                                                <input id="layerDxccDigiJt65" type="checkbox" checked />
                                                <span id="lblLayerDxccDigiJt65">JT65</span>
                                            </label>
                                            <button class="color-btn" type="button" data-color-key="dxcc.digi.jt65" aria-label="Barva: DXCC JT65">
                                                <span class="swatch" data-swatch-key="dxcc.digi.jt65"></span>
                                            </button>
                                        </div>
                                    </li>

                                    <li role="treeitem">
                                        <div class="node leaf">
                                            <span class="twisty" aria-hidden="true"></span>
                                            <label class="layer-item">
                                                <input id="layerDxccDigiRtty" type="checkbox" checked />
                                                <span id="lblLayerDxccDigiRtty">RTTY</span>
                                            </label>
                                            <button class="color-btn" type="button" data-color-key="dxcc.digi.rtty" aria-label="Barva: DXCC RTTY">
                                                <span class="swatch" data-swatch-key="dxcc.digi.rtty"></span>
                                            </button>
                                        </div>
                                    </li>

                                    <li role="treeitem">
                                        <div class="node leaf">
                                            <span class="twisty" aria-hidden="true"></span>
                                            <label class="layer-item">
                                                <input id="layerDxccDigiPsk31" type="checkbox" checked />
                                                <span id="lblLayerDxccDigiPsk31">PSK31</span>
                                            </label>
                                            <button class="color-btn" type="button" data-color-key="dxcc.digi.psk31" aria-label="Barva: DXCC PSK31">
                                                <span class="swatch" data-swatch-key="dxcc.digi.psk31"></span>
                                            </button>
                                        </div>
                                    </li>

                                    <li role="treeitem">
                                        <div class="node leaf">
                                            <span class="twisty" aria-hidden="true"></span>
                                            <label class="layer-item">
                                                <input id="layerDxccDigiPsk63" type="checkbox" checked />
                                                <span id="lblLayerDxccDigiPsk63">PSK63</span>
                                            </label>
                                            <button class="color-btn" type="button" data-color-key="dxcc.digi.psk63" aria-label="Barva: DXCC PSK63">
                                                <span class="swatch" data-swatch-key="dxcc.digi.psk63"></span>
                                            </button>
                                        </div>
                                    </li>

                                    <li role="treeitem">
                                        <div class="node leaf">
                                            <span class="twisty" aria-hidden="true"></span>
                                            <label class="layer-item">
                                                <input id="layerDxccDigiPsk125" type="checkbox" checked />
                                                <span id="lblLayerDxccDigiPsk125">PSK125</span>
                                            </label>
                                            <button class="color-btn" type="button" data-color-key="dxcc.digi.psk125" aria-label="Barva: DXCC PSK125">
                                                <span class="swatch" data-swatch-key="dxcc.digi.psk125"></span>
                                            </button>
                                        </div>
                                    </li>

                                    <li role="treeitem">
                                        <div class="node leaf">
                                            <span class="twisty" aria-hidden="true"></span>
                                            <label class="layer-item">
                                                <input id="layerDxccDigiSstv" type="checkbox" checked />
                                                <span id="lblLayerDxccDigiSstv">SSTV</span>
                                            </label>
                                            <button class="color-btn" type="button" data-color-key="dxcc.digi.sstv" aria-label="Barva: DXCC SSTV">
                                                <span class="swatch" data-swatch-key="dxcc.digi.sstv"></span>
                                            </button>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <!-- Spojnice -->
                    <li role="treeitem" aria-expanded="true">
                        <div class="node">
                            <span class="twisty" aria-hidden="true"></span>
                            <label class="layer-item">
                                <input id="layerLinks" type="checkbox" checked />
                                <span id="lblLayerLinks">Spojnice</span>
                            </label>
                        </div>

                        <ul role="group">
                            <li role="treeitem"><div class="node leaf">
                                <span class="twisty" aria-hidden="true"></span>
                                <label class="layer-item">
                                    <input id="layerLinksCw" type="checkbox" checked />
                                    <span id="lblLayerLinksCw">CW</span>
                                </label>
                            </div></li>

                            <li role="treeitem"><div class="node leaf">
                                <span class="twisty" aria-hidden="true"></span>
                                <label class="layer-item">
                                    <input id="layerLinksSsb" type="checkbox" checked />
                                    <span id="lblLayerLinksSsb">SSB</span>
                                </label>
                            </div></li>

                            <li role="treeitem"><div class="node leaf">
                                <span class="twisty" aria-hidden="true"></span>
                                <label class="layer-item">
                                    <input id="layerLinksOther" type="checkbox" checked />
                                    <span id="lblLayerLinksOther">Ostatní</span>
                                </label>
                            </div></li>

                            <li role="treeitem" aria-expanded="true">
                                <div class="node">
                                    <span class="twisty" aria-hidden="true"></span>
                                    <label class="layer-item">
                                        <input id="layerLinksDigi" type="checkbox" checked />
                                        <span id="lblLayerLinksDigi">DIGI</span>
                                    </label>
                                </div>

                                <ul role="group">
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerLinksDigiFt8" type="checkbox" checked /><span id="lblLayerLinksDigiFt8">FT8</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerLinksDigiFt4" type="checkbox" checked /><span id="lblLayerLinksDigiFt4">FT4</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerLinksDigiJt65" type="checkbox" checked /><span id="lblLayerLinksDigiJt65">JT65</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerLinksDigiRtty" type="checkbox" checked /><span id="lblLayerLinksDigiRtty">RTTY</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerLinksDigiPsk31" type="checkbox" checked /><span id="lblLayerLinksDigiPsk31">PSK31</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerLinksDigiPsk63" type="checkbox" checked /><span id="lblLayerLinksDigiPsk63">PSK63</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerLinksDigiPsk125" type="checkbox" checked /><span id="lblLayerLinksDigiPsk125">PSK125</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerLinksDigiSstv" type="checkbox" checked /><span id="lblLayerLinksDigiSstv">SSTV</span></label>
                                    </div></li>
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <!-- Mode (jen body) -->
                    <li role="treeitem" aria-expanded="true">
                        <div class="node">
                            <span class="twisty" aria-hidden="true"></span>
                            <label class="layer-item">
                                <input id="layerQso" type="checkbox" checked />
                                <span id="lblLayerMode">Mode</span>
                            </label>
                        </div>

                        <ul role="group">
                            <li role="treeitem"><div class="node leaf">
                                <span class="twisty" aria-hidden="true"></span>
                                <label class="layer-item">
                                    <input id="layerQsoCw" type="checkbox" checked />
                                    <span id="lblLayerQsoCw">CW</span>
                                </label>
                            </div></li>

                            <li role="treeitem"><div class="node leaf">
                                <span class="twisty" aria-hidden="true"></span>
                                <label class="layer-item">
                                    <input id="layerQsoSsb" type="checkbox" checked />
                                    <span id="lblLayerQsoSsb">SSB</span>
                                </label>
                            </div></li>

                            <li role="treeitem"><div class="node leaf">
                                <span class="twisty" aria-hidden="true"></span>
                                <label class="layer-item">
                                    <input id="layerQsoOther" type="checkbox" checked />
                                    <span id="lblLayerQsoOther">Ostatní</span>
                                </label>
                            </div></li>

                            <li role="treeitem" aria-expanded="true">
                                <div class="node">
                                    <span class="twisty" aria-hidden="true"></span>
                                    <label class="layer-item">
                                        <input id="layerQsoDigi" type="checkbox" checked />
                                        <span id="lblLayerQsoDigi">DIGI</span>
                                    </label>
                                </div>

                                <ul role="group">
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerQsoDigiFt8" type="checkbox" checked /><span id="lblLayerQsoDigiFt8">FT8</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerQsoDigiFt4" type="checkbox" checked /><span id="lblLayerQsoDigiFt4">FT4</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerQsoDigiJt65" type="checkbox" checked /><span id="lblLayerQsoDigiJt65">JT65</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerQsoDigiRtty" type="checkbox" checked /><span id="lblLayerQsoDigiRtty">RTTY</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerQsoDigiPsk31" type="checkbox" checked /><span id="lblLayerQsoDigiPsk31">PSK31</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerQsoDigiPsk63" type="checkbox" checked /><span id="lblLayerQsoDigiPsk63">PSK63</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerQsoDigiPsk125" type="checkbox" checked /><span id="lblLayerQsoDigiPsk125">PSK125</span></label>
                                    </div></li>
                                    <li role="treeitem"><div class="node leaf"><span class="twisty" aria-hidden="true"></span>
                                        <label class="layer-item"><input id="layerQsoDigiSstv" type="checkbox" checked /><span id="lblLayerQsoDigiSstv">SSTV</span></label>
                                    </div></li>
                                </ul>
                            </li>
                        </ul>
                    </li>

                </ul>
            </li>
        </ul>
    </div>
</div>

<!-- Kontextové menu -->
<div id="contextMenu" role="menu" aria-label="Menu mapy">
    <button id="ctxAddQth" type="button">Přidej Moje QTH</button>
    <button id="ctxExportPng" type="button">Export mapy do PNG</button>
</div>

<!-- Ovládací panel (vpravo vedle vrstev) -->
<div class="info" id="controlPanel">
    <div class="panel-header">
        <div>
            <div class="title" id="appTitle">Hamradio QRB map viewer</div>
            <div class="muted" id="appDesc">Maidenhead Locator: Field (2) / Square (4) / Subsquare (6)</div>
        </div>
        <button id="togglePanel" type="button">Minimalizovat</button>
    </div>

    <div class="panel-body">
        <div class="row lang-row">
            <label id="lblLang">Jazyk:</label>
            <div class="lang-switch" id="langSwitch">
                <button type="button" class="lang-btn active" data-lang="cs">CZ</button>
                <button type="button" class="lang-btn" data-lang="en">EN</button>
            </div>
        </div>

        <div class="row">
            <label for="mode" id="lblGridMode">Mřížka:</label>
            <select id="mode">
                <option value="auto" selected>AUTO</option>
                <option value="field">Field (JN)</option>
                <option value="square">Square (JN89)</option>
                <option value="subsquare">Subsquare (JN89ab)</option>
            </select>
        </div>

        <div class="row">
            <label class="inline-check">
                <span id="lblGridToggle">Zobrazit mřížku</span>
                <input type="checkbox" id="gridToggle" checked />
            </label>
        </div>

        <div class="row">
            <label for="ediFile" id="lblEdi">Import EDI:</label>
            <input id="ediFile" type="file" accept=".d,.D,.edi,.EDI,.adi,.ADI,.adif,.ADIF,text/plain" />
            <button id="importEdi" type="button">Načíst</button>

            <label class="inline-check">
                <span id="lblEdiSetQth">Nastavit QTH z EDI</span>
                <input type="checkbox" id="ediSetQth" checked />
            </label>
        </div>

        <div class="row">
            <label for="locator" id="lblSearch">Vyhledat čtverec:</label>
            <input id="locator" placeholder="např. JN / JN89 / JN89ab" inputmode="latin" autocomplete="off" spellcheck="false" />
            <button id="goLocator" type="button">Najít</button>
            <button id="clearLocator" type="button">Zrušit</button>
        </div>

        <div class="row">
            <label for="qth" id="lblQth">Moje QTH:</label>
            <input id="qth" placeholder="např. JN89ab" inputmode="latin" autocomplete="off" spellcheck="false" />
            <button id="setQth" type="button">Zobrazit</button>
            <button id="clearQth" type="button">Smazat</button>
        </div>

        <div class="row full">
            <label for="targets" id="lblTargetsHelp" class="full">Lokátory (6 znaků, např. JO80AD; jeden na řádek):</label>
            <textarea id="targets" placeholder="JO80AD&#10;JN89AB&#10;..."></textarea>
            <button id="plotTargets" type="button">Zobrazit na mapě</button>
            <button id="clearTargets" type="button">Vymazat</button>
        </div>

        <ol id="locatorList"></ol>

        <div class="muted" id="status"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/ol@latest/dist/ol.js"></script>
<script type="module" src="./js/app.js"></script>
</body>
</html>